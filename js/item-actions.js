import{flexBox,defaultValues}from"./flex-objects.js";import{updateTimeout,updateAll}from"./update-items.js";import{removeItem}from"./remove-item.js";import{getData}from"./get-data.js";import{renderElement,switchesButtonState,setDataInput,setNameItem}from"./utils.js";const elementNameRu="Элемент",elementNameEn="item",primaryLoadItems=2,maxItems=15,nonRemovableItems=2;let countItems=1;const addItemButton=document.querySelector(".button--add-item"),flexContainer=document.querySelector(".parameters__items"),itemTemplate=document.querySelector("#item").content.querySelector(".parameters__fields--item"),removeButtonTemplate=document.querySelector("#remove-button").content.querySelector(".button--remove-item"),getMinMaxValues=e=>{const{minmax:{"min-flex-grow":t,"max-flex-grow":m,"min-flex-shrink":o,"max-flex-shrink":n,"min-flex-basis":a,"max-flex-basis":r,"min-order":s,"max-order":l}}=defaultValues;"flex-grow"===e.name?setDataInput(e,t,m):"flex-shrink"===e.name?setDataInput(e,o,n):"flex-basis"===e.name?setDataInput(e,a,r):"order"===e.name&&setDataInput(e,s,l)},onRemoveButtonClick=e=>{removeItem(e),countItems--},setItemData=e=>{flexBox.items[e]={...defaultValues.items}},setAttributes=(e,t)=>{e.forEach((e=>{e.setAttribute(t,setNameItem(e.getAttribute(t),"-",countItems))}))},onItemFieldsInput=e=>getData(e.target),addItem=e=>{const t=itemTemplate.cloneNode(!0),m=removeButtonTemplate.cloneNode(!0),o=t.querySelector(".parameters__title--item"),n=t.querySelector(".parameters__title-text--item"),a=t.querySelectorAll(".parameters__label"),r=t.querySelectorAll(".field"),s=setNameItem("item","-",countItems),l=setNameItem("Элемент"," ",countItems);var i;setAttributes(a,"for"),setAttributes(r,"id"),t.id=s,n.textContent=l,r.forEach((e=>{getMinMaxValues(e),e.addEventListener("input",onItemFieldsInput)})),renderElement(flexContainer,t),i=s,flexBox.items[i]={...defaultValues.items},countItems>2&&(renderElement(o,m),m.addEventListener("click",onRemoveButtonClick)),e&&updateTimeout(flexBox),countItems++},onAddItemButtonClick=()=>{15===countItems&&switchesButtonState(addItemButton),addItem(!0)},initItemActions=()=>{addItemButton.addEventListener("click",onAddItemButtonClick);for(let e=1;e<=2;e++)addItem(),2===e&&updateAll(flexBox)};export{initItemActions,elementNameRu,elementNameEn};